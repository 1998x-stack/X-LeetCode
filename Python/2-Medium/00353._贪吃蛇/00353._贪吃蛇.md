[353. 贪吃蛇](https://leetcode.cn/problems/design-snake-game)

[ChatGPT](https://chat.openai.com/share/3d9a6163-42d0-459c-90f1-7a18af56139b)

---

## 1. 问题的内容
**1.1 题目描述**：
设计一个贪吃蛇游戏，游戏在一个宽高为 `width x height` 的矩形网格上进行，你需要实现 `SnakeGame` 类：

- `SnakeGame(int width, int height, int[][] food)` 初始化游戏状态，食物 `food` 以 `[[row1,col1],[row2,col2],...]` 的形式给出，蛇从 `(0, 0)` 点开始出发。
- `int move(String direction)` 表示蛇的移动方向，`'U'` = 向上, `'L'` = 向左, `'R'` = 向右, `'D'` = 向下。返回游戏的当前得分，如果游戏结束返回 `-1`。

游戏有以下几个规则：
- 初始时，蛇身体长度为 1，只有头部。
- 蛇向四个方向之一移动，每次移动一格。
- 如果蛇吃到食物，蛇长度增加一格，否则移动后尾部一格消失。
- 蛇不能移动到场地外，也不能碰到自己的身体，否则游戏结束。
- 蛇每吃到一个食物，得分 +1。

**1.2 示例**：
```python
# 初始化一个宽高为 width = 3, height = 2 的游戏，食物位置在 [[1, 2], [0, 1]]
snakeGame = SnakeGame(3, 2, [[1, 2], [0, 1]])

# 返回 0 -> 蛇移动到空格中，没有吃到食物
print(snakeGame.move("R")) 

# 返回 1 -> 蛇吃到了第一个食物，身体长度增加 1
print(snakeGame.move("D")) 

# 返回 1 -> 蛇没有吃到食物，身体不变
print(snakeGame.move("R")) 

# 返回 2 -> 蛇吃到了第二个食物，身体长度增加 1
print(snakeGame.move("U")) 

# 返回 -1 -> 蛇移动出界了，游戏结束
print(snakeGame.move("L")) 
```

**1.3 提示**:
这个问题要求我们模拟一个贪吃蛇游戏的基本逻辑。关键点在于如何高效地管理蛇的身体和处理蛇的移动，尤其是在蛇吃到食物后如何增加长度，以及在蛇移动时如何检测蛇是否碰到自己或者出界。

## 2. 边界情况和约束
1. **边界情况**:
   - 蛇头移动到食物的位置，即蛇吃到食物。
   - 蛇头移动到自己身体的任意部分，即蛇碰到自己，游戏结束。
   - 蛇头移动到游戏区域外，即蛇出界，游戏结束。
   - 食物被蛇吃完，蛇继续移动但不再有食物出现。

2. **约束**:
   - 蛇的移动是格子化的，每次只能移动一格。
   - 蛇身体的长度变化，需要动态管理蛇身体每一部分的位置。
   - 游戏区域是固定大小的矩形网格。
   - 食物的位置是预设的，不能变动，且每次只出现一个食物。

## 3. 算法和策略
1. **数据结构选择**:
   - **蛇身表示**：使用队列（`deque`）存储蛇身每个部位的位置，队首为蛇头。这样方便在蛇移动时添加新的头部位置和去除尾部位置。
   - **食物表示**：将食物数组直接转化为队列（`deque`），便于按顺序获取食物位置。
   - **游戏区域表示**：考虑到需要快速判断蛇的位置是否合法，使用集合（`set`）存储蛇身的位置，以实现O(1)时间复杂度的查找和更新。

2. **初始化**:
   - 初始化游戏区域的宽度和高度。
   - 初始化蛇的位置为 `(0, 0)`。
   - 初始化食物位置列表。
   - 初始化得分为 0。

3. **移动策略**:
   - 根据移动方向更新蛇头的位置。
   - 检查新的蛇头位置是否合法：
     - 是否出界？
     - 是否撞到自己？
   - 如果移动合法，再检查蛇头的新位置是否有食物：
     - 如果有食物，得分加1，蛇长度增加（即不移除尾部），并更新食物位置。
     - 如果没有食物，蛇正常移动，即添加新的头部并移除尾部。
   - 更新蛇身位置集合。

4. **边界情况处理**:
   - 当蛇移动出界或者撞到自己时，游戏结束，返回 `-1`。
   - 当蛇头移动到食物位置，更新得分和蛇的长度，如果食物消耗完，继续游戏直到结束条件触发。

5. **性能优化**:
   - 使用队列和集合可以有效管理蛇身的动态变化和快速判断位置合法性，保证算法效率。
   - 预处理食物位置为队列，避免重复查找和移除操作。

---