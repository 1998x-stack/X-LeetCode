[677. 键值映射](https://leetcode.cn/problems/map-sum-pairs)

[ChatGPT](https://chat.openai.com/share/e1896c5d-3835-4de4-88cf-7fd2d53f4e83)

---

## 1. 问题的内容
**1.1 题目描述**：
[LeetCode 677 - 键值映射](https://leetcode.cn/problems/map-sum-pairs) 要求实现一个结构 `MapSum`，该结构能够存储键值对映射，同时可以根据前缀计算值的总和。具体操作如下：
1. `insert(key: str, val: int)`: 插入或更新键 `key` 对应的值 `val`。
2. `sum(prefix: str)`: 返回所有以 `prefix` 开头的键的值之和。

**1.2 示例**：
insert("apple", 3)
sum("ap")  # 返回 3
insert("app", 2)
sum("ap")  # 返回 5

**1.3 提示**:
- 插入操作应该考虑键已存在时更新其值。
- `sum` 函数需遍历所有键，检查是否以给定前缀开头。

## 2. 边界情况和约束
1. 插入键时键或值为空或为负值的情况。
2. 查询前缀时前缀为空。
3. 频繁更新同一键的性能考量。
4. 极端情况下数据量很大时的性能表现。

## 3. 算法和策略

#### 数据结构选择
- 使用 `dict` 存储键值对，支持快速插入和查询。
- 前缀求和时，遍历 `dict` 检查键的前缀。

#### 算法步骤
1. `insert`:
   - 直接将键值对存入 `dict`，如果键已存在则更新值。
2. `sum`:
   - 遍历所有键，若键以指定前缀开始则累加其值。

#### 代码实现步骤
1. 定义类 `MapSum`。
2. 实现 `insert` 方法：若键存在则更新，不存在则添加。
3. 实现 `sum` 方法：遍历字典，检查键的前缀，进行求和。

#### 边界条件处理
- 插入时检查键或值的有效性。
- 前缀求和时考虑字典为空的情况。

---