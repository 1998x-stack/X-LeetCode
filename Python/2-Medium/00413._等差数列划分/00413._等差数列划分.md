[413. 等差数列划分](https://leetcode.cn/problems/arithmetic-slices)

[ChatGPT](https://chat.openai.com/share/5cbe11b9-9e6f-488e-a68d-c52f458a0ed7)

---

## 1. 问题的内容
**1.1 题目描述**：
等差数列划分问题的目标是找出数组中所有的等差子序列（长度至少为3）的个数。这意味着我们需要识别并计数数组中所有连续的、等差增加的子序列。

- **问题描述**: 给定一个整数数组 `nums`，返回数组 `nums` 中所有为等差数组的子数组个数。子数组是数组的连续子序列，并且至少包含3个元素。如果增加的序列 `a[i], a[i+1], ..., a[j]` 中的所有元素都满足 `a[i+1] - a[i] = a[i+2] - a[i+1] = ... = a[j] - a[j-1]`，那么这个序列是等差的。

**1.2 示例**：
  - 输入: `nums = [1,2,3,4]`
  - 输出: `3`
  - 解释: 数组中有三个子等差数列: `[1,2,3]`, `[2,3,4]` 和 `[1,2,3,4]` 自身。

## 2. 边界情况和约束
- **边界情况**:
  - 数组长度小于3时，不可能形成等差数列，直接返回0。
  - 数组中所有元素相同，这种情况下的等差数列数量需要根据组合数学计算。
  - 数组完全无序，无任何等差数列。

- **约束**:
  - 数组的长度不会超过5000。
  - 数组中的每个元素大小范围是 [-10000, 10000]。

## 3. 算法和策略
为了解决等差数列划分问题，可以采用动态规划的方法。基本思路是遍历数组，对于每个元素，检查它是否可以与前面的某个子序列形成更长的等差数列，或者开始一个新的等差子序列。

- 定义一个一维数组 `dp`，其中 `dp[i]` 表示以 `nums[i]` 结尾的等差数列的个数。注意，这里只计数长度至少为3的子序列。
- 遍历数组，对于每个元素 `nums[i]` (从第三个元素开始，即 `i` 从2开始)，检查与前两个元素的差是否相同，即 `nums[i] - nums[i-1] == nums[i-1] - nums[i-2]`。
- 如果上述条件成立，说明以 `nums[i]` 结尾可以形成一个新的等差数列，其数量为 `dp[i-1] + 1`。原因是以 `nums[i-1]` 结尾的所有等差数列都可以通过添加 `nums[i]` 来延长，且形成一个新的以 `nums[i]` 结尾的长度为3的等差数列。
- 将 `dp[i]` 更新为 `dp[i-1] + 1`，并将其加到总数中。

---