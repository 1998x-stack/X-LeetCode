[355. 设计推特](https://leetcode.cn/problems/design-twitter)

[ChatGPT](https://chat.openai.com/share/9156fadc-b7e6-4163-8943-6e62f4b66851)

---

## 1. 问题的内容
**1.1 题目描述**：
设计一个简化版的推特(Twitter)，可以让用户发布推文，获取自己的新闻推送以及关注/取消关注其他用户。你的设计需要能够支持以下几种功能：
1. `postTweet(userId, tweetId)`: 创建一条新的推文
2. `getNewsFeed(userId)`: 检索最近的十条推文。每个推文都必须是由该用户关注的人或者是用户自己发的。推文必须按照时间顺序由最近的开始排序。
3. `follow(followerId, followeeId)`: 关注一个用户
4. `unfollow(followerId, followeeId)`: 取消关注一个用户

**1.2 示例**：
```
Twitter twitter = new Twitter();
twitter.postTweet(1, 5); // 用户1发布了推文5
twitter.getNewsFeed(1);  // 用户1的新闻推送返回[5]
twitter.follow(1, 2);    // 用户1关注了用户2
twitter.postTweet(2, 6); // 用户2发布了推文6
twitter.getNewsFeed(1);  // 用户1的新闻推送返回[6, 5]
twitter.unfollow(1, 2);  // 用户1取消关注了用户2
twitter.getNewsFeed(1);  // 用户1的新闻推送返回[5]
```

**1.3 提示**:
1. 所有的推文ID都是唯一的。
2. 我们将简化系统，不处理推文的内容分发，也不考虑推文的内容、用户之间的关系网等信息。
3. 关注自己是允许的。
4. 如果两条推文时间相同，则按照创建时间的逆序排序。

## 2. 边界情况和约束
- **边界情况**:
1. 用户首次发推文时，推文列表为空。
2. 用户首次获取新闻推送时，可能没有关注任何人，也可能没有发布任何推文。
3. 用户关注的人没有发布推文时，获取的新闻推送应为空。
4. 用户关注或取消关注的对象包括自己。

- **约束**:
1. 推文ID唯一。
2. 推文获取顺序要求。
3. 关注列表和推文列表的更新和检索效率。
4. 数据结构选择对时间和空间效率的影响。

## 3. 算法和策略
#### 数据结构选择:
1. **推文存储**: 使用列表或链表存储每个用户的推文ID，以保证插入效率。
2. **用户关系**: 使用字典存储每个用户的关注列表，键为用户ID，值为其关注用户的集合，以优化查找和更新效率。
3. **全局推文索引**: 使用时间戳标记每条推文，确保推文的时间顺序。可以考虑将用户ID和推文ID打包，存储在优先队列或堆中，以快速检索最新的推文。

#### 算法设计:
1. **postTweet**: 向用户的推文列表添加新推文，同时更新全局推文索引。
2. **getNewsFeed**: 遍历用户的关注列表，从每个关注的用户的推文列表中获取最新的推文，加入优先队列中，然后选出最新的10条推文返回。
3. **follow** 和 **unfollow**: 更新用户的关注列表。

#### 策略优化:
- 为了优化`getNewsFeed`的性能，可以限制存储每个用户最新的N条推文，减少遍历的数量。
- 使用堆（优先队列）来快速获取最新的推文，避免全量排序。

---