[399. 除法求值](https://leetcode.cn/problems/evaluate-division)

[ChatGPT](https://chat.openai.com/share/8e67658b-a89d-4b53-b63f-e7d08dea2fcd)

---

## 1. 问题的内容
**1.1 题目描述**：
LeetCode 399题「除法求值」要求根据给定的除法方程，求解多个除法查询的结果。每个除法方程由两个变量 `a` 和 `b` 以及它们的结果 `k` 组成，表示等式 `a / b = k`。查询也是以类似的变量对形式给出，要求计算它们的除法结果。

**1.2 示例**：
给定方程式 `[ ["a","b"],["b","c"] ]`，值为 `[2.0,3.0]`，以及查询 `[ ["a","c"],["b","a"],["a","e"],["a","a"],["x","x"] ]`。基于给定的方程式，我们可以得出：

- `a / b = 2.0`
- `b / c = 3.0`

从而可以推导出：

- `a / c = 6.0` (因为 `a / b * b / c = a / c`)
- `b / a = 0.5` (因为 `1 / (a / b) = b / a`)
- `a / e` 和 `x / x` 因为 `e` 和 `x` 没有在方程中出现，所以结果为 `-1.0`

**1.3 提示**:
这个问题本质上是要求我们在一个图中找到两个节点之间的路径，并计算这条路径上的权重乘积。我们可以将每个变量看作图中的一个节点，将除法关系转化为有向边，边的权重即为除法的结果。查询两个变量之间的除法结果就相当于在图中寻找一条从一个变量到另一个变量的路径，并计算该路径上所有边权重的乘积。

## 2. 边界情况和约束
1. **边界情况**：
   - 查询中的某个变量不在任何给定的方程中出现。
   - 方程中可能存在多条路径可以连接同一对变量，但是它们的除法结果应该是相同的。
   - 可能存在环路，例如 `a / b = 2`, `b / c = 3`, `c / a = 0.5`。

2. **约束**：
   - 方程数量和查询数量可能会很大，需要高效算法。
   - 给定的除法结果是双精度浮点数，计算时需要注意精度问题。

## 3. 算法和策略
1. **使用图表示除法方程**：
   - 创建一个图，其中每个节点表示一个变量，每条有向边表示一个除法关系，边的权重是除法的结果。
   - 对于方程 `a / b = k`，添加从 `a` 到 `b` 的有向边，权重为 `k`，同时添加从 `b` 到 `a` 的有向边，权重为 `1/k`。

2. **处理查询**：
   - 对于每个查询 `x / y`，使用深度优先搜索（DFS）或广度优先搜索（BFS）在图中查找从 `x` 到 `y` 的路径。
   - 如果存在路径，计算路径上所有边的权重乘积，即为 `x / y` 的结果。
   - 如果不存在路径，返回 `-1.0`。

3. **优化和注意事项**：
   - 为了提高效率，可以预处理所有可能的查询结果，并将其存储在哈希表中，这样每个查询的时间复杂度就可以降低到 O(1)。
   - 注意处理精度问题，因为连续的浮点数乘法可能导致精度损失。

---