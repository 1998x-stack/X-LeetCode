[370. 区间加法](https://leetcode.cn/problems/range-addition)

[ChatGPT](https://chat.openai.com/share/a3ada635-9f29-490a-b941-716e524058dd)

---

## 1. 问题的内容
**1.1 题目描述**：
LeetCode 370题 “区间加法” 要求我们对一个初始全为0的数组，执行一系列的区间操作，最终返回操作后的数组。每一个操作都是在数组的一个指定区间内加上一个值。

给定长度为 `length` 的数组，和一个操作数组 `updates`，其中每个操作 `updates[i] = [startIdx, endIdx, inc]` 表示数组从 `startIdx` 到 `endIdx`（包括两端点）的每个元素都加上 `inc`。需要返回执行所有操作后的数组。

**1.2 示例**：
假设输入为 `length = 5`, `updates = [[1,3,2],[2,4,3],[0,2,-2]]`，初始数组为 `[0, 0, 0, 0, 0]`：

- 第一次操作后数组变为 `[0, 2, 2, 2, 0]`。
- 第二次操作后数组变为 `[0, 2, 5, 5, 3]`。
- 第三次操作后数组变为 `[-2, 0, 3, 5, 3]`。

所以，最终的输出应该是 `[-2, 0, 3, 5, 3]`。

**1.3 提示**:
- 注意到直接按照操作来更新数组会导致时间复杂度较高，尤其是当操作数组很大时。
- 可以考虑使用**差分数组**技巧来高效地进行区间加法操作。

## 2. 边界情况和约束
- **边界情况**：
  - 操作数组 `updates` 为空，即没有任何操作，应返回初始数组。
  - 操作区间的开始和结束索引超出数组长度，这种情况应在实现前规避或处理，以避免索引越界。
  - `inc` 为负数，这是合法的，表示对区间内的数进行减法操作。

- **约束**：
  - `length` >= 0，数组长度非负。
  - 操作的索引 `startIdx` 和 `endIdx` 应满足 0 <= `startIdx` <= `endIdx` < `length`。

## 3. 算法和策略
使用**差分数组**技术设计算法：

1. **初始化差分数组**：创建一个长度为 `length` 的差分数组 `diff`，差分数组的每个元素初始化为0。差分数组 `diff[i]` 表示原数组在 `i` 位置相比于 `i-1` 位置的增量。

2. **应用更新操作到差分数组**：
   - 对于每个操作 `[startIdx, endIdx, inc]`：
     - 在差分数组 `diff` 的 `startIdx` 位置加上 `inc`，表示从 `startIdx` 开始，数组的每个元素应该增加 `inc`。
     - 在 `endIdx + 1` 位置减去 `inc`（如果 `endIdx + 1` 在数组长度范围内），表示从 `endIdx + 1` 开始，增量应该抵消。

3. **通过差分数组构建最终数组**：
   - 创建一个长度为 `length` 的结果数组，第一个元素与差分数组的第一个元素相同（因为差分数组的第一个元素就是原数组的第一个元素的增量）。
   - 从第二个元素开始，每个元素是它前一个元素加上差分数组对应位置的增量。

---