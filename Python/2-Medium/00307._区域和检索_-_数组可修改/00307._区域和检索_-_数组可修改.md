[307. 区域和检索 - 数组可修改](https://leetcode.cn/problems/range-sum-query-mutable)

[ChatGPT](https://chat.openai.com/share/5be528c4-f544-4c18-9532-e2cea5e4a721)

---

## 1. 问题的内容
**1.1 题目描述**：
- **题目链接**: [307. 区域和检索 - 数组可修改](https://leetcode.cn/problems/range-sum-query-mutable)
- **核心问题**: 实现一个数据结构，该结构能够完成对一个整数数组的修改操作和区间和查询操作。
- **操作类型**:
  - **修改**: 更新数组中的一个元素。
  - **查询**: 获取数组中一个区间（闭区间）内所有元素的和。

**1.2 示例**：
- **输入**: 
  - `["NumArray", "sumRange", "update", "sumRange"]`
  - `[[[1, 3, 5]], [0, 2], [1, 2], [0, 2]]`
- **输出**: 
  - `[null, 9, null, 8]`
- **解释**:
  - 初始状态下数组为 `[1,3,5]`。
  - `sumRange(0, 2)` -> 返回 9，因为 `1 + 3 + 5 = 9`。
  - `update(1, 2)` -> 将数组中索引为 1 的元素更新为 2，数组变为 `[1,2,5]`。
  - `sumRange(0, 2)` -> 返回 8，因为 `1 + 2 + 5 = 8`。

**1.3 提示**:
- 数组的元素数量和修改操作的数量在实际应用中可能非常大，需要寻找时间效率较高的解决方案。

## 2. 边界情况和约束
- **数组长度**：数组可能非常长，因此空间和时间效率都很重要。
- **操作次数**：修改和查询操作可能非常频繁，需要快速响应。
- **元素范围**：元素值可能为任意整数，包括负数。
- **索引有效性**：保证查询和修改操作的索引都在数组范围内。
- **初始化时间**：初始化数据结构的时间也应考虑在内。

## 3. 算法和策略
**线段树基本思想**：
- 线段树是一种二叉树结构，它将一个区间划分成多个子区间，并为每个子区间维护一个值（如区间和、最小/最大值等）。
- 对于数组的区间查询操作，线段树能在 `O(log n)` 时间复杂度内完成。
- 对于数组的元素修改操作，线段树也能在 `O(log n)` 时间复杂度内完成。

**算法设计**:
1. **构建线段树**：
   - 以递归方式构建。
   - 每个节点表示一个区间的和。
   - 叶子节点表示数组的单个元素。
2. **查询区间和**：
   - 递归查询左右子树，合并结果。
   - 如果查询区间完全包含节点区间，则直接返回节点值。
3. **更新元素**：
   - 递归到叶子节点进行更新。
   - 更新后，回溯更新所有父节点的值。

---